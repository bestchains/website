"use strict";(self.webpackChunkbestchains=self.webpackChunkbestchains||[]).push([[506],{3905:(e,t,n)=>{n.d(t,{Zo:()=>p,kt:()=>d});var r=n(7294);function a(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function o(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function c(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?o(Object(n),!0).forEach((function(t){a(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):o(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function l(e,t){if(null==e)return{};var n,r,a=function(e,t){if(null==e)return{};var n,r,a={},o=Object.keys(e);for(r=0;r<o.length;r++)n=o[r],t.indexOf(n)>=0||(a[n]=e[n]);return a}(e,t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);for(r=0;r<o.length;r++)n=o[r],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(a[n]=e[n])}return a}var i=r.createContext({}),s=function(e){var t=r.useContext(i),n=t;return e&&(n="function"==typeof e?e(t):c(c({},t),e)),n},p=function(e){var t=s(e.components);return r.createElement(i.Provider,{value:t},e.children)},u="mdxType",m={inlineCode:"code",wrapper:function(e){var t=e.children;return r.createElement(r.Fragment,{},t)}},k=r.forwardRef((function(e,t){var n=e.components,a=e.mdxType,o=e.originalType,i=e.parentName,p=l(e,["components","mdxType","originalType","parentName"]),u=s(n),k=a,d=u["".concat(i,".").concat(k)]||u[k]||m[k]||o;return n?r.createElement(d,c(c({ref:t},p),{},{components:n})):r.createElement(d,c({ref:t},p))}));function d(e,t){var n=arguments,a=t&&t.mdxType;if("string"==typeof e||a){var o=n.length,c=new Array(o);c[0]=k;var l={};for(var i in t)hasOwnProperty.call(t,i)&&(l[i]=t[i]);l.originalType=e,l[u]="string"==typeof e?e:a,c[1]=l;for(var s=2;s<o;s++)c[s]=n[s];return r.createElement.apply(null,c)}return r.createElement.apply(null,n)}k.displayName="MDXCreateElement"},2519:(e,t,n)=>{n.r(t),n.d(t,{assets:()=>i,contentTitle:()=>c,default:()=>m,frontMatter:()=>o,metadata:()=>l,toc:()=>s});var r=n(7462),a=(n(7294),n(3905));const o={sidebar_position:1,title:"\u667a\u80fd\u5408\u7ea6\u5f00\u53d1",sidebar_label:"\u667a\u80fd\u5408\u7ea6\u5f00\u53d1"},c=void 0,l={unversionedId:"DevGuide/contract_dev",id:"DevGuide/contract_dev",title:"\u667a\u80fd\u5408\u7ea6\u5f00\u53d1",description:"Bestchains\u5e73\u53f0\u76ee\u524d\u4ec5\u652f\u6301Hyperledger Fabric Chaincode Golang \u5408\u7ea6\u3002\u56e0\u6b64\uff0c\u5f00\u53d1\u4eba\u5458\u9700\u8981\u5177\u5907:",source:"@site/docs/DevGuide/contract_dev.md",sourceDirName:"DevGuide",slug:"/DevGuide/contract_dev",permalink:"/website/docs/DevGuide/contract_dev",draft:!1,tags:[],version:"current",sidebarPosition:1,frontMatter:{sidebar_position:1,title:"\u667a\u80fd\u5408\u7ea6\u5f00\u53d1",sidebar_label:"\u667a\u80fd\u5408\u7ea6\u5f00\u53d1"},sidebar:"docsSidebar",previous:{title:"\u5f00\u53d1\u6307\u5357",permalink:"/website/docs/category/\u5f00\u53d1\u6307\u5357"},next:{title:"\u5e94\u7528\u5f00\u53d1",permalink:"/website/docs/DevGuide/app_dev"}},i={},s=[{value:"\u9884\u5148\u51c6\u5907",id:"\u9884\u5148\u51c6\u5907",level:2},{value:"\u5f00\u53d1\u73af\u5883",id:"\u5f00\u53d1\u73af\u5883",level:3},{value:"\u672c\u5730\u5f00\u53d1\u73af\u5883",id:"\u672c\u5730\u5f00\u53d1\u73af\u5883",level:4},{value:"Gitpod\u5728\u7ebf\u5f00\u53d1",id:"gitpod\u5728\u7ebf\u5f00\u53d1",level:4},{value:"\u51c6\u5907\u4e00\u4e2a\u533a\u5757\u94fe\u6d4b\u8bd5\u7f51\u7edc",id:"\u51c6\u5907\u4e00\u4e2a\u533a\u5757\u94fe\u6d4b\u8bd5\u7f51\u7edc",level:3},{value:"\u5f00\u53d1\u6559\u7a0b",id:"\u5f00\u53d1\u6559\u7a0b",level:2},{value:"1. \u5b9a\u4e49\u5408\u7ea6\u63a5\u53e3",id:"1-\u5b9a\u4e49\u5408\u7ea6\u63a5\u53e3",level:3},{value:"2. \u5b9e\u73b0\u5408\u7ea6\u63a5\u53e3",id:"2-\u5b9e\u73b0\u5408\u7ea6\u63a5\u53e3",level:3},{value:"2.1 \u5b9a\u4e49\u4e8b\u4ef6\uff08Event\uff09",id:"21-\u5b9a\u4e49\u4e8b\u4ef6event",level:4},{value:"3. \u7f16\u5199\u5165\u53e3\u51fd\u6570",id:"3-\u7f16\u5199\u5165\u53e3\u51fd\u6570",level:3},{value:"4. \u5b89\u88c5\u90e8\u7f72",id:"4-\u5b89\u88c5\u90e8\u7f72",level:3},{value:"5. \u5408\u7ea6\u65b9\u6cd5\u6d4b\u8bd5",id:"5-\u5408\u7ea6\u65b9\u6cd5\u6d4b\u8bd5",level:3},{value:"5.1 \u67e5\u8be2\u5408\u7ea6 Metadata",id:"51-\u67e5\u8be2\u5408\u7ea6-metadata",level:4},{value:"5.2 \u901a\u8fc7 Client CLI \u6784\u9020\u4ea4\u6613",id:"52-\u901a\u8fc7-client-cli-\u6784\u9020\u4ea4\u6613",level:4},{value:"6. \u6821\u9a8c\u5408\u7ea6\u6267\u884c\u7ed3\u679c",id:"6-\u6821\u9a8c\u5408\u7ea6\u6267\u884c\u7ed3\u679c",level:3}],p={toc:s},u="wrapper";function m(e){let{components:t,...o}=e;return(0,a.kt)(u,(0,r.Z)({},p,o,{components:t,mdxType:"MDXLayout"}),(0,a.kt)("p",null,"Bestchains\u5e73\u53f0\u76ee\u524d\u4ec5\u652f\u6301",(0,a.kt)("a",{parentName:"p",href:"https://hyperledger-fabric.readthedocs.io/en/latest/sdk_chaincode.html"},"Hyperledger Fabric Chaincode Golang \u5408\u7ea6"),"\u3002\u56e0\u6b64\uff0c\u5f00\u53d1\u4eba\u5458\u9700\u8981\u5177\u5907:"),(0,a.kt)("ul",null,(0,a.kt)("li",{parentName:"ul"},"Chaincode \u5408\u7ea6\u5f00\u53d1\u80fd\u529b"),(0,a.kt)("li",{parentName:"ul"},"Go \u8bed\u8a00\u5f00\u53d1\u80fd\u529b")),(0,a.kt)("p",null,"Bestchains \u63d0\u4f9b",(0,a.kt)("a",{parentName:"p",href:"https://github.com/bestchains/bestchains-contracts"},"\u667a\u80fd\u5408\u7ea6\u5f00\u53d1\u5e93"),"\uff0c\u5f00\u53d1\u8005\u53ef\u4ee5\u53c2\u8003",(0,a.kt)("a",{parentName:"p",href:"https://github.com/bestchains/bestchains-contracts/tree/main/examples"},"\u793a\u4f8b"),"\u5b9e\u73b0\u3002\u4e0b\u9762\uff0c\u4ecb\u7ecd\u5982\u4f55\u4f7f\u7528 Bestchains \u5e73\u53f0\u5b8c\u6210\u5408\u7ea6\u7684\u5f00\u53d1\u53ca\u6d4b\u8bd5\uff1a"),(0,a.kt)("h2",{id:"\u9884\u5148\u51c6\u5907"},"\u9884\u5148\u51c6\u5907"),(0,a.kt)("h3",{id:"\u5f00\u53d1\u73af\u5883"},"\u5f00\u53d1\u73af\u5883"),(0,a.kt)("h4",{id:"\u672c\u5730\u5f00\u53d1\u73af\u5883"},"\u672c\u5730\u5f00\u53d1\u73af\u5883"),(0,a.kt)("ol",null,(0,a.kt)("li",{parentName:"ol"},"\u51c6\u5907\u5f00\u53d1\u73af\u5883")),(0,a.kt)("ul",null,(0,a.kt)("li",{parentName:"ul"},(0,a.kt)("a",{parentName:"li",href:"https://go.dev/"},"Go 1.20")),(0,a.kt)("li",{parentName:"ul"},"IDE: ",(0,a.kt)("a",{parentName:"li",href:"https://code.visualstudio.com/"},"VSCode")," \uff08\u63a8\u8350\uff09/ ",(0,a.kt)("a",{parentName:"li",href:"https://www.jetbrains.com/go"},"GoLand"))),(0,a.kt)("ol",{start:2},(0,a.kt)("li",{parentName:"ol"},"\u514b\u9686\u4ee3\u7801\u5e93")),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-shell"},"git clone https://github.com/bestchains/bestchains-contracts.git\n")),(0,a.kt)("h4",{id:"gitpod\u5728\u7ebf\u5f00\u53d1"},"Gitpod\u5728\u7ebf\u5f00\u53d1"),(0,a.kt)("ol",null,(0,a.kt)("li",{parentName:"ol"},"\u624b\u52a8\u6253\u5f00",(0,a.kt)("a",{parentName:"li",href:"https://gitpod.io/"},(0,a.kt)("inlineCode",{parentName:"a"},"Gitpod"),"\u5b98\u7f51"))),(0,a.kt)("p",null,(0,a.kt)("img",{alt:"Gitpod",src:n(2185).Z,width:"1599",height:"789"})),(0,a.kt)("blockquote",null,(0,a.kt)("p",{parentName:"blockquote"},"\u4efb\u610f\u9009\u62e9\u4e00\u79cd\u767b\u5f55\u65b9\u5f0f\uff0c\u63a8\u8350Github\u767b\u5f55")),(0,a.kt)("ol",{start:2},(0,a.kt)("li",{parentName:"ol"},"\u521b\u5efaWorkspace")),(0,a.kt)("p",null,(0,a.kt)("img",{alt:"Gitpod",src:n(3865).Z,width:"890",height:"477"})),(0,a.kt)("ol",{start:3},(0,a.kt)("li",{parentName:"ol"},"\u914d\u7f6erepository")),(0,a.kt)("p",null,(0,a.kt)("img",{alt:"Gitpod",src:n(9099).Z,width:"1088",height:"473"})),(0,a.kt)("admonition",{type:"tip"},(0,a.kt)("p",{parentName:"admonition"},"  \u63a8\u8350\u5148fork ",(0,a.kt)("inlineCode",{parentName:"p"},"bestchains/bestchains-contracts"),"\u4ed3\u5e93\uff0c\u7136\u540e\u518dgitpod\u4e2d\u4f7f\u7528fork\u4ed3\u5e93\u5f00\u53d1")),(0,a.kt)("h3",{id:"\u51c6\u5907\u4e00\u4e2a\u533a\u5757\u94fe\u6d4b\u8bd5\u7f51\u7edc"},"\u51c6\u5907\u4e00\u4e2a\u533a\u5757\u94fe\u6d4b\u8bd5\u7f51\u7edc"),(0,a.kt)("p",null,"\u901a\u8fc7Bestchains\u5e73\u53f0\u521b\u5efa\u5982\u4e0b\u6700\u5c0f\u914d\u7f6e\u7684\u7f51\u7edc:"),(0,a.kt)("ul",null,(0,a.kt)("li",{parentName:"ul"},"\u7f51\u7edc\u5171\u8bc6\u96c6\u7fa4\u8bbe\u7f6e\u4e3a 1 \u4e2a\u8282\u70b9\uff0c\u91c7\u7528\u9ed8\u8ba4\u8d44\u6e90\u914d\u7f6e"),(0,a.kt)("li",{parentName:"ul"},"\u901a\u9053\u4ec5\u5305\u542b 1 \u4e2a\u62e5\u6709 1 \u540d\u7528\u6237\u7684\u7ec4\u7ec7"),(0,a.kt)("li",{parentName:"ul"},"\u901a\u9053\u4ec5 1 \u4e2a\u7ec4\u7ec7\u8282\u70b9\u52a0\u5165")),(0,a.kt)("h2",{id:"\u5f00\u53d1\u6559\u7a0b"},"\u5f00\u53d1\u6559\u7a0b"),(0,a.kt)("blockquote",null,(0,a.kt)("p",{parentName:"blockquote"},"\u4ee5",(0,a.kt)("a",{parentName:"p",href:"https://github.com/bestchains/bestchains-contracts/tree/main/examples/nonce"},"nonce\u5408\u7ea6"),"\u4e3a\u4f8b")),(0,a.kt)("h3",{id:"1-\u5b9a\u4e49\u5408\u7ea6\u63a5\u53e3"},"1. \u5b9a\u4e49\u5408\u7ea6\u63a5\u53e3"),(0,a.kt)("p",null,(0,a.kt)("strong",{parentName:"p"},"contracts/nonce/interfaces.go")),(0,a.kt)("p",null,"\u5982\u4e0b\u6240\u793a:"),(0,a.kt)("blockquote",null,(0,a.kt)("p",{parentName:"blockquote"},(0,a.kt)("a",{parentName:"p",href:"https://github.com/bestchains/bestchains-contracts/blob/main/contracts/nonce/interfaces.go"},"https://github.com/bestchains/bestchains-contracts/blob/main/contracts/nonce/interfaces."))),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-go"},'import "github.com/bestchains/bestchains-contracts/library/context"\n\n\ntype INonce interface {\n    Check(context.ContextInterface, string, uint64) error\n    Current(context.ContextInterface, string) (uint64, error)\n    Increment(context.ContextInterface, string) (uint64, error)\n}\n')),(0,a.kt)("p",null,"Nonce\u5408\u7ea6\u5b9a\u4e49\u4e86\u4e09\u4e2a\u63a5\u53e3\uff0c\u5206\u522b\u4e3a:"),(0,a.kt)("ul",null,(0,a.kt)("li",{parentName:"ul"},"Check \uff1a\u6821\u9a8c\u8d26\u6237\u5bf9\u5e94\u7684 nonce \u503c\u662f\u5426\u6b63\u786e"),(0,a.kt)("li",{parentName:"ul"},"Current : \u67e5\u8be2\u8d26\u6237\u5f53\u524d\u7684 nonce \u503c"),(0,a.kt)("li",{parentName:"ul"},"Increment : \u8d26\u6237\u5f53\u524d nonce++")),(0,a.kt)("p",null,"\u5408\u7ea6\u51fd\u6570\u4e2d\uff0c\u7b2c\u4e00\u4e2a\u53c2\u6570\u6c38\u8fdc\u4e3a ",(0,a.kt)("a",{parentName:"p",href:"https://github.com/bestchains/bestchains-contracts/blob/main/library/context/context.go#L45"},"Context"),"\uff0c\u7528\u4e8e\u83b7\u53d6\u5f53\u524d\u4ea4\u6613\u8bf7\u6c42\u7684\u4e0a\u4e0b\u6587\u4ee5\u53ca\u83b7\u53d6\u72b6\u6001\u6570\u636e\u5e93\u6700\u65b0\u72b6\u6001\u3002\u4e3a\u4e86\u65b9\u4fbf\u4f7f\u7528\uff0c\u5728\u5b98\u65b9 ",(0,a.kt)("a",{parentName:"p",href:"https://github.com/hyperledger/fabric-contract-api-go/blob/main/contractapi/transaction_context.go#L15"},"context")," \u57fa\u7840\u4e0a\u6269\u5c55\u4e86\u5bf9\u4e8c\u7ea7\u4ea4\u6613\u53d1\u9001\u8005 (etheruem account) \u7684\u652f\u6301\u3002"),(0,a.kt)("h3",{id:"2-\u5b9e\u73b0\u5408\u7ea6\u63a5\u53e3"},"2. \u5b9e\u73b0\u5408\u7ea6\u63a5\u53e3"),(0,a.kt)("p",null,(0,a.kt)("strong",{parentName:"p"},"contracts/nonce/nonce.go")),(0,a.kt)("blockquote",null,(0,a.kt)("p",{parentName:"blockquote"},(0,a.kt)("a",{parentName:"p",href:"https://github.com/bestchains/bestchains-contracts/blob/main/contracts/nonce/nonce.go"},"https://github.com/bestchains/bestchains-contracts/blob/main/contracts/nonce/nonce.go"))),(0,a.kt)("p",null,"\u4ee5\u63a5\u53e3 Increment \u4e3a\u4f8b:"),(0,a.kt)("ul",null,(0,a.kt)("li",{parentName:"ul"},"Increment")),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-go"},'const (\n    NoncePrefix = "nonce~account"\n)\nfunc (nonce *Nonce) Increment(ctx context.ContextInterface, account string) (uint64, error) {\n    nonceKey, err := ctx.GetStub().CreateCompositeKey(NoncePrefix, []string{account})\n    if err != nil {\n        return 0, err\n        }\n        val, err := ctx.GetStub().GetState(nonceKey)\n        if err != nil {\n            return 0, err\n        }\n        counter, err := library.BytesToCounter(val)\n        if err != nil {\n            return 0, err\n        }\n        counter.Increment()\n\n        err = ctx.GetStub().PutState(nonceKey, counter.Bytes())\n        if err != nil {\n             return 0, err\n        }\n        return counter.Current(), nil\n    }\n')),(0,a.kt)("p",null,"\u901a\u8fc7 ",(0,a.kt)("inlineCode",{parentName:"p"},"CreateCompositeKey")," \u6784\u5efa\u7ec4\u5408 ",(0,a.kt)("inlineCode",{parentName:"p"},"key"),"\uff0c\u7136\u540e\u901a\u8fc7 ",(0,a.kt)("inlineCode",{parentName:"p"},"GetState")," \u5411\u72b6\u6001\u6570\u636e\u5e93\u67e5\u8be2\u5f53\u524d\u6700\u65b0\u7684 ",(0,a.kt)("inlineCode",{parentName:"p"},"nonce")," \u503c\uff0c\u4ee4\u5176\u81ea\u589e\u540e\u901a\u8fc7 ",(0,a.kt)("inlineCode",{parentName:"p"},"PutState")," \u66f4\u65b0\u5230\u72b6\u6001\u6570\u636e\u5e93\u4e2d\u3002\u6240\u6709\u9700\u8981\u6301\u7eed\u5b58\u50a8\u7684\u6570\u636e\u5747\u9700\u4ee5\u4e0a\u8ff0\u65b9\u5f0f\u5bf9\u72b6\u6001\u6570\u636e\u5e93\u4e2d\u5b58\u53d6\u3002"),(0,a.kt)("h4",{id:"21-\u5b9a\u4e49\u4e8b\u4ef6event"},"2.1 \u5b9a\u4e49\u4e8b\u4ef6\uff08Event\uff09"),(0,a.kt)("p",null,"\u5728\u4e00\u4e9b\u5e94\u7528\u573a\u666f\u4e2d\uff0c\u6211\u4eec\u5e0c\u671b\u8c03\u7528\u5408\u7ea6\u63a5\u53e3\u7684\u64cd\u4f5c\u6216\u7ed3\u679c\u80fd\u591f\u5e7f\u64ad\u544a\u77e5\u540c\u4e00\u901a\u9053\u4e0a\u7684\u5176\u4ed6\u7528\u6237\u3001\u5e94\u7528\u6216\u63a5\u53e3\uff0c\u4f8b\u5982\u5b8c\u6210\u4e00\u7b14\u4ea4\u6613\u3001\u4e00\u6b21\u58f0\u660e\u7b49\u3002\u6b64\u65f6\u4fbf\u53ef\u4ee5\u5728\u5408\u7ea6\u63a5\u53e3\u5b9e\u73b0\u4e2d\u901a\u8fc7 ",(0,a.kt)("inlineCode",{parentName:"p"},"EmitEvent")," \u751f\u6210\u4e00\u4e2a",(0,a.kt)("strong",{parentName:"p"},"\u4e8b\u4ef6"),"\u3002\u4ee5 ",(0,a.kt)("inlineCode",{parentName:"p"},"ERC-20")," \u5408\u7ea6\u4e3a\u4f8b\uff1a"),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-go"},'func _transfer(ctx context.ContextInterface, from string, to string, amount uint64) error {\n    var err error\n    toAddr := library.Address(to)\n    fromAddr := library.Address(from)\n\n    // validate address\n\n    // beforeTokenTransfer\n\n    senderBalanceKey, err := ctx.GetStub().CreateCompositeKey(BalancePrefix, []string{from})\n    if err != nil {\n        return err\n    }\n    receiverBalanceKey, err := ctx.GetStub().CreateCompositeKey(BalancePrefix, []string{to})\n    if err != nil {\n        return err\n    }\n\n        senderBalanceVal, err := ctx.GetStub().GetState(senderBalanceKey)\n        if err != nil {\n            return err\n    }\n    receiverBalanceVal, err := ctx.GetStub().GetState(receiverBalanceKey)\n    if err != nil {\n        return err\n    }\n\n    senderBalance, err := library.BytesToUint64(senderBalanceVal)\n    if err != nil {\n        return err\n    }\n    receiverBalance, err := library.BytesToUint64(receiverBalanceVal)\n    if err != nil {\n        return err\n    }\n\n    if senderBalance < amount {\n        return fmt.Errorf("transferred more than it has")\n    }\n\n    err = ctx.GetStub().PutState(senderBalanceKey, []byte(library.Uint64ToString(amount+receiverBalance)))\n    if err != nil {\n        return err\n    }\n\n    err = ctx.GetStub().PutState(receiverBalanceKey, []byte(library.Uint64ToString(senderBalance-amount)))\n    if err != nil {\n        return err\n    }\n\n    if err = ctx.EmitEvent("Transfer", &EventTransfer{\n        Operator: ctx.MsgSender(),\n        From:     fromAddr,\n        To:       toAddr,\n        Value:    amount,\n    }); err != nil {\n        return errors.Wrap(err, "Event Transfer")\n    }\n\n    // afterTokenTransfer\n\n    return nil\n}\n')),(0,a.kt)("p",null," ",(0,a.kt)("inlineCode",{parentName:"p"},"_transfer")," \u51fd\u6570\u5b9e\u73b0\u4e86\u4ea4\u6613\u63a5\u53e3\u529f\u80fd\uff0c\u5c06\u6307\u5b9a\u6570\u91cf\u7684 token \u4ece from \u5730\u5740\u79fb\u4ea4\u81f3 to \u5730\u5740\u3002\u4f9d\u636e ",(0,a.kt)("inlineCode",{parentName:"p"},"ERC-20")," \u5408\u7ea6\u7684\u8981\u6c42\uff0c\u8be5\u51fd\u6570\u751f\u6210\u4e00\u4e2a ",(0,a.kt)("inlineCode",{parentName:"p"},"Transfer")," \u4e8b\u4ef6\uff0c\u5185\u5bb9\u5305\u62ec\u4ea4\u6613\u7684\u64cd\u4f5c\u8005\u3001\u53d1\u9001\u65b9\u3001\u63a5\u6536\u65b9\u3001\u4ea4\u6613\u91cf\u3002\u5f53\u4e00\u7b14\u4ea4\u6613\u53d1\u751f\u540e\uff0c\u901a\u9053\u4e2d\u76d1\u542c\u8be5\u7c7b\u4e8b\u4ef6\u7684\u5e94\u7528\u4fbf\u4f1a\u5f97\u5230\u4e8b\u4ef6\u7684\u901a\u77e5\u3002"),(0,a.kt)("h3",{id:"3-\u7f16\u5199\u5165\u53e3\u51fd\u6570"},"3. \u7f16\u5199\u5165\u53e3\u51fd\u6570"),(0,a.kt)("p",null,(0,a.kt)("strong",{parentName:"p"},"examples/nonce/main.go")),(0,a.kt)("p",null,"\u5982\u4e0b\u6240\u793a:"),(0,a.kt)("blockquote",null,(0,a.kt)("p",{parentName:"blockquote"},(0,a.kt)("a",{parentName:"p",href:"https://github.com/bestchains/bestchains-contracts/blob/main/examples/nonce/main.go"},"https://github.com/bestchains/bestchains-contracts/blob/main/examples/nonce/main.go"))),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-go"},'package main\n    \n    import (\n        "github.com/bestchains/bestchains-contracts/contracts/nonce"\n        "github.com/bestchains/bestchains-contracts/library/context"\n        "github.com/hyperledger/fabric-contract-api-go/contractapi"\n    )\n    \n    func main() {\n        nonceContract := new(nonce.Nonce)\n        nonceContract.Name = "org.bestchains.com.NonceContract"\n        nonceContract.TransactionContextHandler = new(context.Context)\n        nonceContract.BeforeTransaction = context.BeforeTransaction\n    \n        cc, err := contractapi.NewChaincode(nonceContract)\n        if err != nil {\n            panic(err.Error())\n        }\n    \n        if err := cc.Start(); err != nil {\n            panic(err.Error())\n        }\n    }\n')),(0,a.kt)("ul",null,(0,a.kt)("li",{parentName:"ul"},"\u521d\u59cb\u5316\u5408\u7ea6\u5b9e\u4f8b")),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-go"},"    nonceContract := new(nonce.Nonce)\n")),(0,a.kt)("ul",null,(0,a.kt)("li",{parentName:"ul"},"\u8bbe\u7f6e ",(0,a.kt)("strong",{parentName:"li"},"TransactionContextHandler")," \u4e3a\u6269\u5c55 ",(0,a.kt)("strong",{parentName:"li"},"context"))),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-go"},"    nonceContract.TransactionContextHandler = new(context.Context)\n")),(0,a.kt)("ul",null,(0,a.kt)("li",{parentName:"ul"},"\u8bbe\u7f6e ",(0,a.kt)("strong",{parentName:"li"},"BeforeTransaction")," \u4e3a\u6269\u5c55 Context")),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-go"},"    nonceContract.BeforeTransaction = context.BeforeTransaction\n")),(0,a.kt)("ul",null,(0,a.kt)("li",{parentName:"ul"},"\u521d\u59cb\u5316 Chaincode")),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-go"},"    cc, err := contractapi.NewChaincode(nonceContract)\n")),(0,a.kt)("h3",{id:"4-\u5b89\u88c5\u90e8\u7f72"},"4. \u5b89\u88c5\u90e8\u7f72"),(0,a.kt)("blockquote",null,(0,a.kt)("p",{parentName:"blockquote"},"\u53c2\u8003",(0,a.kt)("strong",{parentName:"p"},"\u5feb\u901f\u4f7f\u7528"),"\uff1a ",(0,a.kt)("a",{parentName:"p",href:"https://github.com/bestchains/website/blob/main/docs/QuickStart/usage.md"},"QuickStart/usage"))),(0,a.kt)("h3",{id:"5-\u5408\u7ea6\u65b9\u6cd5\u6d4b\u8bd5"},"5. \u5408\u7ea6\u65b9\u6cd5\u6d4b\u8bd5"),(0,a.kt)("blockquote",null,(0,a.kt)("p",{parentName:"blockquote"},"\u53c2\u8003:  ",(0,a.kt)("a",{parentName:"p",href:"https://github.com/bestchains/bc-explorer#client"},"bestchains/bc-explorer/cmd/client"))),(0,a.kt)("h4",{id:"51-\u67e5\u8be2\u5408\u7ea6-metadata"},"5.1 \u67e5\u8be2\u5408\u7ea6 Metadata"),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-shell"},"./client -profile network.json -contract nonce -method org.hyperledger.fabric:GetMetadata\n")),(0,a.kt)("blockquote",null,(0,a.kt)("p",{parentName:"blockquote"},"NOTE: \u5982\u679c\u5408\u7ea6\u90e8\u7f72\u6b63\u5e38\uff0c\u6b64\u5904\u5c06\u8fd4\u56de\u5408\u7ea6\u5185\u5b9a\u4e49\u7684\u65b9\u6cd5\u3001\u53c2\u6570\u7b49\u4fe1\u606f")),(0,a.kt)("h4",{id:"52-\u901a\u8fc7-client-cli-\u6784\u9020\u4ea4\u6613"},"5.2 \u901a\u8fc7 Client CLI \u6784\u9020\u4ea4\u6613"),(0,a.kt)("ul",null,(0,a.kt)("li",{parentName:"ul"},"\u67e5\u8be2\u8d26\u6237 0xacccount \u5f53\u524d\u7684 nonce \u503c")),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-shell"},"./client -profile network.json -contract nonce -method Current -args 0xaccount\n")),(0,a.kt)("ul",null,(0,a.kt)("li",{parentName:"ul"},"\u589e\u52a0\u8d26\u6237 0xaccount \u7684 nonce")),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-shell"},"./client -profile network.json -contract nonce -method Increment -args 0xaccount\n")),(0,a.kt)("h3",{id:"6-\u6821\u9a8c\u5408\u7ea6\u6267\u884c\u7ed3\u679c"},"6. \u6821\u9a8c\u5408\u7ea6\u6267\u884c\u7ed3\u679c"),(0,a.kt)("blockquote",null,(0,a.kt)("p",{parentName:"blockquote"},"\u901a\u8fc7 Bestchains \u5e73\u53f0\u7684\u533a\u5757\u94fe\u6d4f\u89c8\u5668\uff0c\u67e5\u770b\u5bf9\u5e94\u7f51\u7edc\u7684\u4ea4\u6613\u8be6\u60c5")))}m.isMDXComponent=!0},9099:(e,t,n)=>{n.d(t,{Z:()=>r});const r=n.p+"assets/images/gitpod-repo-889665f1123152a770fa2b0bc41c064b.png"},2185:(e,t,n)=>{n.d(t,{Z:()=>r});const r=n.p+"assets/images/gitpod-website-cf26faa503a4b5aab3dca31a95616f6d.png"},3865:(e,t,n)=>{n.d(t,{Z:()=>r});const r=n.p+"assets/images/gitpod-workspace-48e347a8214dd1fe8af116e99328486a.png"}}]);